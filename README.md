# Nanopore Isomers

Cataloging isomers of nanopores (extended vacancy defects) in 2D lattices

> Govind Rajan, A.; Silmore, K.; Swett, J.; Robertson, A. W.; Warner, J. H.; Blankschtein, D.; Strano, M. S. Addressing the Isomer Cataloguing Problem for Nanopores in Two-Dimensional Materials. Nature Materials, In Press.

## Contents

**All bundled codes are written in MATLAB, and have been fully checked for compatibility with MATLAB R2016b. The following are the included programs:**

* `generate_isomers`: This program calls the `kmc_isomers` code repeatedly in order to stochastically generate a pre-determined number of isomers. To do so, the program requires:

  * `kmc_isomers`: This program carries out a kinetic Monte Carlo (KMC) simulation to stochastically generate one nanopore of a given size in the graphene lattice, and saves the XYZ file and the directed adjacency matrix of each generated nanopore.

* `analyze_isomers_directed_isomorphism`: This program analyzes all the nanopore isomers generated using the `generate_isomers` code to weed the duplicate isomers out of the list, and output the unique isomers. To do so, the program requires:

  * `add_weighing_nodes_in_between`: This program modifies the antimolecule adjacency matrix to add fictitious nodes to enable proper detection of C-C bonds with various orientations (see Nat. Mater. paper)

  * `compare_pores_with_weights`: This program compares two nanopore isomers, after fictitious nodes have been added into their adjacency matrices using `add_weighing_nodes_in_between`, and outputs whether the two nanopores are identical or not. 

 **Post-processed results are stored in the directory `catalog` under two distinct folders (`without_edge_diffusion` and `with_edge_diffusion` corresponding to the cases without and with edge diffusion of atoms, respectively):**
 
 * The data for a nanopore of size `N` is stored within the subdirectory `poreN`, e.g., `pore6`,`pore16`, and so on.
 
 * The XYZ file for each most-probable isomer (MPI) of size `N` is named as: `N_MPI#_Count.xyz`, where `N` is the size of the nanopore (in terms of the number of atoms removed to form the nanopore), `MPI#` is the rank of the MPI (e.g., MPI# = 6 for the 6th most-probable isomer in the dataset), and `Count` is the number of times that MPI was observed in 1000 kinetic Monte Carlo (KMC) runs leading to the formation of an `N`-sized nanopore. For example, the 4th MPI for `N`=10 appeared 40 times in 1000 KMC runs, and its XYZ file is named as `010_004_040.xyz`.
 
**Raw data is stored in the directory `catalog > raw_data` under two distinct folders (`without_edge_diffusion` and `with_edge_diffusion` corresponding to the cases without and with edge diffusion of atoms, respectively):**
 
 * The data for a nanopore of size `N` is stored within the subdirectory `poreN`, e.g., `pore6`,`pore16`, and so on.
 
 * Each `poreN` subdirectory contains a CSV file named `Analysis.csv`. This file has 10 columns, with the columns representing, for each of the 1000 nanopores obtained in KMC simulations, in order: (i) the index of the KMC simulation (between 1 and 1000, typically), (ii) the formation time of the nanopore, (iii) the time for the nanopore to enlarge by 1 atom, (iv) the number of dangling bonds at the pore rim, (v) the number of rim carbon atoms with 2 missing bonds, (vi) the number of rim carbon atoms with 1 missing bond, (vii) the number of armchair atoms, (viii) the number of zigzag atoms, (ix) the number of "unassigned" atoms (Singh, A. K., Penev, E. S. & Yakobson, B. I. Comput. Phys. Commun. 182, 804â€“807 (2011)), and (x) the number of five-membered rings in the lattice. Note that in our work, the "unassigned" and armchair atoms are treated to be the same with respect to etching barriers and rates.
 
 * Each `poreN` subdirectory also contains another CSV file named `isomerData_N.csv`. This file has 2 columns, and maps each KMC run number to an isomer number. The number of KMC runs is typically 1000. Note that the number of isomers is typically less than the number of KMC runs.
 
 * Each `poreN` subdirectory contains 1000 XYZ files (corresponding to the 1000 KMC runs) named as `poreIndex.xyz` where `Index` is a number between 1 and 1000. For example, the nanopore generated by the 500th run of the KMC would be named as `pore500.xyz'.
 
 * Each `poreN` subdirectory contains 1000 "directed" adjacency matrices corresponding to the antimolecules of each of the 1000 nanopores. Thes files are named as `adjmat_directed_antimol_Index.txt`
 
 * Each `poreN` subdirectory also contains a TXT representation for each of the 1000 nanopores. These files are named as `poreIndex.txt`. The first line of the TXT representation is the size of the hexagonal graphene lattice in which the nanopore is present. The next `N` rows contain the `(sublattice,i,j)` indices of each of the `N` removed atoms, where `sublattice` is the sublattice on which the removed atom is present (1 or 2 corresponding to A or B), and `i` is the row index and `j` is the column index of the removed atom.
 
 * Each `poreN` subdirectory also contains a directory named `isomers`. This directory contains the structures of the nanopore isomers extracted from the 1000 KMC simulations. Each XYZ file inside the `isomers` directory is named as `N_MPI#_Copy.xyz`, where `N` is the size of the nanopore (in terms of the number of atoms removed to form the nanopore), `MPI#` is the rank of the MPI, and `Copy` is the index for the number of times the isomer was observed till that KMC run. The `isomers` directory also contains the corresponding TXT files and "directed" adjacency matrices named as `N_MPI#_Copy.txt` and `adjmat_directed_antimol_N_MPI#_Copy.txt`, respectively.
